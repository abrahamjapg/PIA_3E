import os
import pefile
def
def analyze_pe(file_path):
    #Analiza un archivo PE utilizando pefile
    try:
        pe = pefile.PE(file_path)
        print(f"Analizando: {file_path}")
        #Entrypoint representa la dirección dentro del archivo donde comenzará la ejecución del programa.
        print(f"Entrypoint (Punto de entrada): {hex(pe.OPTIONAL_HEADER.AddressOfEntryPoint)}")
        #ImageBase representa la dirección preferida en memoria donde el programa se cargará.
        print(f"ImageBase: {hex(pe.OPTIONAL_HEADER.ImageBase)}")
    except Exception as e:
        print(f"Error analizando {file_path}: {e}")

def analyze_folder(folder_path):
    #Aplica el análisis PE a todos los archivos de una carpeta
    for root, dirs, files in os.walk(folder_path):
        for file in files:
            file_path = os.path.join(root, file)
            if file.endswith('.exe'):
                analyze_pe(file_path)

# Ruta de la carpeta a analizar
folder_path = 'C:\\Users\\David\\Documents\\Juegos'
analyze_folder(folder_path)
